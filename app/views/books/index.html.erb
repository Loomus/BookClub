<h1>Books Index</h1>

<nav id="sorting">
  <%= link_to "Highest Rated", books_path(sort: :rating, order: :desc) %>
  <%= link_to "Lowest Rated", books_path(sort: :rating, order: :asc) %>
  <%= link_to "Highest Page Count", books_path(sort: :pages, order: :desc) %>
  <%= link_to "Lowest Page Count", books_path(sort: :pages, order: :asc) %>
  <%= link_to "Most Reviewed", books_path(sort: :reviews, order: :desc) %>
  <%= link_to "Least Reviewed", books_path(sort: :reviews, order: :asc) %>
  <%= link_to "Add a Book", new_book_path %>
</nav>

  <section id="book-statistics">
    <ul id="highest-rated">
    <% @highest_rated.each do |book| %>
    <li>
      <%= link_to book.title, book_path(book) %>
    </li>
    <li>
      Average Rating: <%= book.avg_rating %>
    </li>
    <% end %>
  </ul>
  <ul id="worst-rated">
    <% @lowest_rated.each do |book| %>
    <li>
      <%= link_to book.title, book_path(book) %>
    </li>
    <li>
      Average Rating: <%= book.avg_rating %>
    </li>
    <% end %>
    </ul>
  <ul id="most-reviews">
    <% @top_users.each do |user| %>
    <li>
      <%= link_to user.name, user_path(user) %>
    </li>
    <li>
      Total Reviews: <%= user.reviews.count %>
    </li>
    <% end %>
    </ul>
  </section>

<div id="books">
   <% @books.each do |book| %>
  <ul id="book-info-<%= book.id %>">
    <li>
      <%= link_to book.title, book_path(book) %>
    </li>
    <li>
      <%= book.pages %>
    </li>
    <li>
      <%= book.year %>
    </li>
      <img class="img-thumbnail" src="<%= book.cover_image %>">
    <% book.authors.each do |author| %>
    <p>
      Authored By: <%= link_to author.name, author_path(author) %>
    </p>
    <% end %>
    <ul id="book-rev-stat-<%= book.id %>">
      <li>Average Rating: <%= book.avg_rating %></li>
      <li>Total Reviews: <%= book.review_count.to_i %></li>
    </ul>
<% end %>
</div>
<% if @no_reviews != nil %>
<div id="not-reviewed">
  <% @no_reviews.each do |book| %>
 <ul>
   <li>
     <%= link_to book.title, book_path(book) %>
   </li>
   <li>
     <%= book.pages %>
   </li>
   <li>
     <%= book.year %>
   </li>
     <img class="img-thumbnail" src="<%= book.cover_image %>">
   <% book.authors.each do |author| %>
   <p>
     Authored By: <%= link_to author.name, author_path(author) %>
   </p>
   <% end %>
  </ul>
<% end %>
</div>
<% end %>
